{"version":3,"sources":["../../../../src/lib-esm/ui/js/highlight-helpers.js"],"names":["original","highlighted","value","processed","result","nodeStack","isElement","arg","_a","attributes","selectStream","length","offset","event","open","node","Error","tag","map","call","attr","nodeName","escapeHTML","replace","join","close","render","stream","substring","reverse","forEach","splice","push","pop","substr","toLowerCase","nodeStream","child","firstChild","nextSibling","nodeType","nodeValue","match"],"mappings":"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","sourcesContent":["function escapeHTML(value) {\n    return value.replace(/&/gm, '&amp;').replace(/</gm, '&lt;').replace(/>/gm, '&gt;');\n}\nfunction tag(node) {\n    return node.nodeName.toLowerCase();\n}\nexport function nodeStream(node) {\n    var result = [];\n    var nodeStream = function (node, offset) {\n        for (var child = node.firstChild; child; child = child.nextSibling) {\n            if (child.nodeType === 3 && child.nodeValue !== null) {\n                offset += child.nodeValue.length;\n            }\n            else if (child.nodeType === 1) {\n                result.push({\n                    event: 'start',\n                    offset: offset,\n                    node: child,\n                });\n                offset = nodeStream(child, offset);\n                if (!tag(child).match(/br|hr|img|input/)) {\n                    result.push({\n                        event: 'stop',\n                        offset: offset,\n                        node: child,\n                    });\n                }\n            }\n        }\n        return offset;\n    };\n    nodeStream(node, 0);\n    return result;\n}\nexport function mergeStreams(original, highlighted, value) {\n    var processed = 0;\n    var result = '';\n    var nodeStack = [];\n    function isElement(arg) {\n        var _a;\n        return arg !== null && ((_a = arg) === null || _a === void 0 ? void 0 : _a.attributes) !== undefined;\n    }\n    function selectStream() {\n        if (!original.length || !highlighted.length) {\n            return original.length ? original : highlighted;\n        }\n        if (original[0].offset !== highlighted[0].offset) {\n            return original[0].offset < highlighted[0].offset ? original : highlighted;\n        }\n        return highlighted[0].event === 'start' ? original : highlighted;\n    }\n    function open(node) {\n        if (!isElement(node)) {\n            throw new Error('Node is not an Element');\n        }\n        result += \"<\" + tag(node) + \" \" + Array()\n            .map.call(node.attributes, function (attr) { return attr.nodeName + \"=\\\"\" + escapeHTML(attr.value).replace(/\"/g, '&quot;') + \"\\\"\"; })\n            .join(' ') + \">\";\n    }\n    function close(node) {\n        result += '</' + tag(node) + '>';\n    }\n    function render(event) {\n        (event.event === 'start' ? open : close)(event.node);\n    }\n    while (original.length || highlighted.length) {\n        var stream = selectStream();\n        result += escapeHTML(value.substring(processed, stream[0].offset));\n        processed = stream[0].offset;\n        if (stream === original) {\n            nodeStack.reverse().forEach(close);\n            do {\n                render(stream.splice(0, 1)[0]);\n                stream = selectStream();\n            } while (stream === original && stream.length && stream[0].offset === processed);\n            nodeStack.reverse().forEach(open);\n        }\n        else {\n            if (stream[0].event === 'start') {\n                nodeStack.push(stream[0].node);\n            }\n            else {\n                nodeStack.pop();\n            }\n            render(stream.splice(0, 1)[0]);\n        }\n    }\n    return result + escapeHTML(value.substr(processed));\n}\n//# sourceMappingURL=highlight.js-helpers.js.map"],"file":"highlight-helpers.min.js"}