define ("qtype_coderunner/lib-esm/ui/js/diff2html-ui-base",["exports","./highlight-helpers","../../diff2html"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.Diff2HtmlUI=a.defaultDiff2HtmlUIConfig=void 0;var d=void 0||function(){d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b){if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}}return a};return d.apply(this,arguments)},e=d(d({},c.defaultDiff2HtmlConfig),{synchronisedScroll:!0,highlight:!0,fileListToggle:!0,fileListStartVisible:!1,smartSelection:!0});a.defaultDiff2HtmlUIConfig=e;var f=function(){function a(a,b,f,g){if(void 0===f){f={}}this.hljs=null;this.currentSelectionColumnId=-1;this.config=d(d({},e),f);this.diffHtml=b!==void 0?(0,c.html)(b,this.config):a.innerHTML;this.targetElement=a;if(g!==void 0)this.hljs=g}a.prototype.draw=function(){this.targetElement.innerHTML=this.diffHtml;if(this.config.synchronisedScroll)this.synchronisedScroll();if(this.config.highlight)this.highlightCode();if(this.config.fileListToggle)this.fileListToggle(this.config.fileListStartVisible)};a.prototype.synchronisedScroll=function(){this.targetElement.querySelectorAll(".d2h-file-wrapper").forEach(function(a){var b=[].slice.call(a.querySelectorAll(".d2h-file-side-diff")),c=b[0],d=b[1];if(c===void 0||d===void 0)return;var e=function(a){if(null===a||null===a.target)return;if(a.target===c){d.scrollTop=c.scrollTop;d.scrollLeft=c.scrollLeft}else{c.scrollTop=d.scrollTop;c.scrollLeft=d.scrollLeft}};c.addEventListener("scroll",e);d.addEventListener("scroll",e)})};a.prototype.fileListToggle=function(a){var b=this.targetElement.querySelector(".d2h-show"),c=this.targetElement.querySelector(".d2h-hide"),d=this.targetElement.querySelector(".d2h-file-list");if(null===b||null===c||null===d)return;var e=function(){b.style.display="none";c.style.display="inline";d.style.display="block"},f=function(){b.style.display="inline";c.style.display="none";d.style.display="none"};b.addEventListener("click",function(){return e()});c.addEventListener("click",function(){return f()});var g=this.getHashTag();if("files-summary-show"===g)e();else if("files-summary-hide"===g)f();else if(a)e();else f()};a.prototype.highlightCode=function(){var a=this;if(null===this.hljs){throw new Error("Missing a `highlight.js` implementation. Please provide one when instantiating Diff2HtmlUI.")}var c=this.targetElement.querySelectorAll(".d2h-file-wrapper");c.forEach(function(c){var d,e,f=c.querySelectorAll(".d2h-code-line-ctn");f.forEach(function(f){if(null===a.hljs)return;var g=f.textContent,h=f.parentNode;if(null===g||null===h||!a.isElement(h))return;var i=h.classList.contains("d2h-del")?d:e,j=c.getAttribute("data-lang"),k=j&&a.hljs.getLanguage(j)?a.hljs.highlight(j,g,!0,i):a.hljs.highlightAuto(g);if(a.instanceOfIHighlightResult(k)){if(h.classList.contains("d2h-del")){d=k.top}else if(h.classList.contains("d2h-ins")){e=k.top}else{d=k.top;e=k.top}}var l=(0,b.nodeStream)(f);if(l.length){var m=document.createElementNS("http://www.w3.org/1999/xhtml","div");m.innerHTML=k.value;k.value=(0,b.mergeStreams)(l,(0,b.nodeStream)(m),g)}f.classList.add("hljs");f.classList.add(k.language);f.innerHTML=k.value})})};a.prototype.smartSelection=function(){console.warn("Smart selection is now enabled by default with CSS. No need to call this method anymore.")};a.prototype.instanceOfIHighlightResult=function(a){return"top"in a};a.prototype.getHashTag=function(){var a=document.URL,b=a.indexOf("#"),c=null;if(-1!==b){c=a.substr(b+1)}return c};a.prototype.isElement=function(a){var b;return null!==a&&(null===(b=a)||void 0===b?void 0:b.classList)!==void 0};return a}();a.Diff2HtmlUI=f});
//# sourceMappingURL=diff2html-ui-base.min.js.map
