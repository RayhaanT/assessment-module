function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("qtype_coderunner/lib-esm/render-utils",["exports","qtype_coderunner/diff","./utils","./rematch","./types"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.toCSSClass=function(a){switch(a){case e.LineType.CONTEXT:return q.CONTEXT;case e.LineType.INSERT:return q.INSERTS;case e.LineType.DELETE:return q.DELETES;}};a.escapeForHtml=l;a.deconstructLine=m;a.filenameDiff=n;a.getHtmlId=function(a){return"d2h-"+(0,c.hashCode)(n(a)).toString().slice(-6)};a.getFileIcon=function(a){var b="file-changed";if(a.isRename){b="file-renamed"}else if(a.isCopy){b="file-renamed"}else if(a.isNew){b="file-added"}else if(a.isDeleted){b="file-deleted"}else if(a.newName!==a.oldName){b="file-renamed"}return b};a.diffHighlight=o;a.defaultRenderConfig=a.CSSLineClass=void 0;b=g(b);d=g(d);function f(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;f=function(){return a};return a}function g(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=f();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var g=d?Object.getOwnPropertyDescriptor(a,e):null;if(g&&(g.get||g.set)){Object.defineProperty(c,e,g)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}var p=void 0||function(){p=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b){if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}}return a};return p.apply(this,arguments)},q={INSERTS:"d2h-ins",DELETES:"d2h-del",CONTEXT:"d2h-cntx",INFO:"d2h-info",INSERT_CHANGES:"d2h-ins d2h-change",DELETE_CHANGES:"d2h-del d2h-change"};a.CSSLineClass=q;var r={matching:e.LineMatchingType.NONE,matchWordsThreshold:.25,maxLineLengthHighlight:1e4,diffStyle:e.DiffStyleType.WORD};a.defaultRenderConfig=r;var s="/",t=d.newDistanceFn(function(a){return a.value}),u=d.newMatcherFn(t);function h(a){return-1!==a.indexOf("dev/null")}function i(a){return a.replace(/(<ins[^>]*>((.|\n)*?)<\/ins>)/g,"")}function j(a){return a.replace(/(<del[^>]*>((.|\n)*?)<\/del>)/g,"")}function k(a){return a?2:1}function l(a){return a.slice(0).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function m(a,b,c){if(void 0===c){c=!0}var d=k(b);return{prefix:a.substring(0,d),content:c?l(a.substring(d)):a.substring(d)}}function n(a){var b=(0,c.unifyPath)(a.oldName),d=(0,c.unifyPath)(a.newName);if(b!==d&&!h(b)&&!h(d)){var e=[],f=[],g=b.split(s),l=d.split(s),m=g.length,n=l.length,o=0,p=m-1,q=n-1;while(o<p&&o<q){if(g[o]===l[o]){e.push(l[o]);o+=1}else{break}}while(p>o&&q>o){if(g[p]===l[q]){f.unshift(l[q]);p-=1;q-=1}else{break}}var r=e.join(s),t=f.join(s),u=g.slice(o,p+1).join(s),v=l.slice(o,q+1).join(s);if(r.length&&t.length){return r+s+"{"+u+" \u2192 "+v+"}"+s+t}else if(r.length){return r+s+"{"+u+" \u2192 "+v+"}"}else if(t.length){return"{"+u+" \u2192 "+v+"}"+s+t}return b+" \u2192 "+d}else if(!h(d)){return d}else{return b}}function o(a,c,d,e){if(void 0===e){e={}}var f=p(p({},r),e),g=f.matching,h=f.maxLineLengthHighlight,k=f.matchWordsThreshold,n=f.diffStyle,o=m(a,d,!1),q=m(c,d,!1);if(o.content.length>h||q.content.length>h){return{oldLine:{prefix:o.prefix,content:l(o.content)},newLine:{prefix:q.prefix,content:l(q.content)}}}var s="char"===n?b.diffChars(o.content,q.content):b.diffWordsWithSpace(o.content,q.content),v=[];if("word"===n&&"words"===g){var w=s.filter(function(a){return a.removed}),x=s.filter(function(a){return a.added}),y=u(x,w);y.forEach(function(a){if(1===a[0].length&&1===a[1].length){var b=t(a[0][0],a[1][0]);if(b<k){v.push(a[0][0]);v.push(a[1][0])}}})}var z=s.reduce(function(a,b){var c=b.added?"ins":b.removed?"del":null,d=-1<v.indexOf(b)?" class=\"d2h-change\"":"",e=l(b.value);return null!==c?a+"<"+c+d+">"+e+"</"+c+">":""+a+e},"");return{oldLine:{prefix:o.prefix,content:i(z)},newLine:{prefix:q.prefix,content:j(z)}}}});
//# sourceMappingURL=render-utils.min.js.map
