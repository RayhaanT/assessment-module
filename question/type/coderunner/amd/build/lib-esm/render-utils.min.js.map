{"version":3,"sources":["../../src/lib-esm/render-utils.js"],"names":["lineType","LineType","CONTEXT","CSSLineClass","INSERT","INSERTS","DELETE","DELETES","file","filenameDiff","toString","slice","templateName","isRename","isCopy","isNew","isDeleted","newName","oldName","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","INFO","INSERT_CHANGES","DELETE_CHANGES","defaultRenderConfig","matching","LineMatchingType","NONE","matchWordsThreshold","maxLineLengthHighlight","diffStyle","DiffStyleType","WORD","separator","distance","rematch","newDistanceFn","change","value","matcher","newMatcherFn","isDevNullName","name","indexOf","removeInsElements","line","replace","removeDelElements","prefixLength","isCombined","escapeForHtml","str","deconstructLine","escape","indexToSplit","prefix","substring","content","oldFilename","newFilename","prefixPaths","suffixPaths","oldFilenameParts","split","newFilenameParts","oldFilenamePartsSize","newFilenamePartsSize","j","k","push","unshift","finalPrefix","join","finalSuffix","oldRemainingPath","newRemainingPath","diffHighlight","diffLine1","diffLine2","config","_a","line1","line2","oldLine","newLine","diff","jsDiff","diffChars","diffWordsWithSpace","changedWords","removed","filter","element","added","chunks","forEach","chunk","dist","highlightedLine","reduce","part","elemType","addClass","escapedValue"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as jsDiff from 'qtype_coderunner/diff';\nimport { unifyPath, hashCode } from './utils';\nimport * as rematch from './rematch';\nimport { LineMatchingType, DiffStyleType, LineType } from './types';\nexport var CSSLineClass = {\n    INSERTS: 'd2h-ins',\n    DELETES: 'd2h-del',\n    CONTEXT: 'd2h-cntx',\n    INFO: 'd2h-info',\n    INSERT_CHANGES: 'd2h-ins d2h-change',\n    DELETE_CHANGES: 'd2h-del d2h-change',\n};\nexport var defaultRenderConfig = {\n    matching: LineMatchingType.NONE,\n    matchWordsThreshold: 0.25,\n    maxLineLengthHighlight: 10000,\n    diffStyle: DiffStyleType.WORD,\n};\nvar separator = '/';\nvar distance = rematch.newDistanceFn(function (change) { return change.value; });\nvar matcher = rematch.newMatcherFn(distance);\nfunction isDevNullName(name) {\n    return name.indexOf('dev/null') !== -1;\n}\nfunction removeInsElements(line) {\n    return line.replace(/(<ins[^>]*>((.|\\n)*?)<\\/ins>)/g, '');\n}\nfunction removeDelElements(line) {\n    return line.replace(/(<del[^>]*>((.|\\n)*?)<\\/del>)/g, '');\n}\nexport function toCSSClass(lineType) {\n    switch (lineType) {\n        case LineType.CONTEXT:\n            return CSSLineClass.CONTEXT;\n        case LineType.INSERT:\n            return CSSLineClass.INSERTS;\n        case LineType.DELETE:\n            return CSSLineClass.DELETES;\n    }\n}\nfunction prefixLength(isCombined) {\n    return isCombined ? 2 : 1;\n}\nexport function escapeForHtml(str) {\n    return str\n        .slice(0)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#x27;')\n        .replace(/\\//g, '&#x2F;');\n}\nexport function deconstructLine(line, isCombined, escape) {\n    if (escape === void 0) { escape = true; }\n    var indexToSplit = prefixLength(isCombined);\n    return {\n        prefix: line.substring(0, indexToSplit),\n        content: escape ? escapeForHtml(line.substring(indexToSplit)) : line.substring(indexToSplit),\n    };\n}\nexport function filenameDiff(file) {\n    var oldFilename = unifyPath(file.oldName);\n    var newFilename = unifyPath(file.newName);\n    if (oldFilename !== newFilename && !isDevNullName(oldFilename) && !isDevNullName(newFilename)) {\n        var prefixPaths = [];\n        var suffixPaths = [];\n        var oldFilenameParts = oldFilename.split(separator);\n        var newFilenameParts = newFilename.split(separator);\n        var oldFilenamePartsSize = oldFilenameParts.length;\n        var newFilenamePartsSize = newFilenameParts.length;\n        var i = 0;\n        var j = oldFilenamePartsSize - 1;\n        var k = newFilenamePartsSize - 1;\n        while (i < j && i < k) {\n            if (oldFilenameParts[i] === newFilenameParts[i]) {\n                prefixPaths.push(newFilenameParts[i]);\n                i += 1;\n            }\n            else {\n                break;\n            }\n        }\n        while (j > i && k > i) {\n            if (oldFilenameParts[j] === newFilenameParts[k]) {\n                suffixPaths.unshift(newFilenameParts[k]);\n                j -= 1;\n                k -= 1;\n            }\n            else {\n                break;\n            }\n        }\n        var finalPrefix = prefixPaths.join(separator);\n        var finalSuffix = suffixPaths.join(separator);\n        var oldRemainingPath = oldFilenameParts.slice(i, j + 1).join(separator);\n        var newRemainingPath = newFilenameParts.slice(i, k + 1).join(separator);\n        if (finalPrefix.length && finalSuffix.length) {\n            return (finalPrefix + separator + '{' + oldRemainingPath + ' → ' + newRemainingPath + '}' + separator + finalSuffix);\n        }\n        else if (finalPrefix.length) {\n            return finalPrefix + separator + '{' + oldRemainingPath + ' → ' + newRemainingPath + '}';\n        }\n        else if (finalSuffix.length) {\n            return '{' + oldRemainingPath + ' → ' + newRemainingPath + '}' + separator + finalSuffix;\n        }\n        return oldFilename + ' → ' + newFilename;\n    }\n    else if (!isDevNullName(newFilename)) {\n        return newFilename;\n    }\n    else {\n        return oldFilename;\n    }\n}\nexport function getHtmlId(file) {\n    return \"d2h-\" + hashCode(filenameDiff(file)).toString().slice(-6);\n}\nexport function getFileIcon(file) {\n    var templateName = 'file-changed';\n    if (file.isRename) {\n        templateName = 'file-renamed';\n    }\n    else if (file.isCopy) {\n        templateName = 'file-renamed';\n    }\n    else if (file.isNew) {\n        templateName = 'file-added';\n    }\n    else if (file.isDeleted) {\n        templateName = 'file-deleted';\n    }\n    else if (file.newName !== file.oldName) {\n        templateName = 'file-renamed';\n    }\n    return templateName;\n}\nexport function diffHighlight(diffLine1, diffLine2, isCombined, config) {\n    if (config === void 0) { config = {}; }\n    var _a = __assign(__assign({}, defaultRenderConfig), config), matching = _a.matching, maxLineLengthHighlight = _a.maxLineLengthHighlight, matchWordsThreshold = _a.matchWordsThreshold, diffStyle = _a.diffStyle;\n    var line1 = deconstructLine(diffLine1, isCombined, false);\n    var line2 = deconstructLine(diffLine2, isCombined, false);\n    if (line1.content.length > maxLineLengthHighlight || line2.content.length > maxLineLengthHighlight) {\n        return {\n            oldLine: {\n                prefix: line1.prefix,\n                content: escapeForHtml(line1.content),\n            },\n            newLine: {\n                prefix: line2.prefix,\n                content: escapeForHtml(line2.content),\n            },\n        };\n    }\n    var diff = diffStyle === 'char'\n        ? jsDiff.diffChars(line1.content, line2.content)\n        : jsDiff.diffWordsWithSpace(line1.content, line2.content);\n    var changedWords = [];\n    if (diffStyle === 'word' && matching === 'words') {\n        var removed = diff.filter(function (element) { return element.removed; });\n        var added = diff.filter(function (element) { return element.added; });\n        var chunks = matcher(added, removed);\n        chunks.forEach(function (chunk) {\n            if (chunk[0].length === 1 && chunk[1].length === 1) {\n                var dist = distance(chunk[0][0], chunk[1][0]);\n                if (dist < matchWordsThreshold) {\n                    changedWords.push(chunk[0][0]);\n                    changedWords.push(chunk[1][0]);\n                }\n            }\n        });\n    }\n    var highlightedLine = diff.reduce(function (highlightedLine, part) {\n        var elemType = part.added ? 'ins' : part.removed ? 'del' : null;\n        var addClass = changedWords.indexOf(part) > -1 ? ' class=\"d2h-change\"' : '';\n        var escapedValue = escapeForHtml(part.value);\n        return elemType !== null\n            ? highlightedLine + \"<\" + elemType + addClass + \">\" + escapedValue + \"</\" + elemType + \">\"\n            : \"\" + highlightedLine + escapedValue;\n    }, '');\n    return {\n        oldLine: {\n            prefix: line1.prefix,\n            content: removeInsElements(highlightedLine),\n        },\n        newLine: {\n            prefix: line2.prefix,\n            content: removeDelElements(highlightedLine),\n        },\n    };\n}\n//# sourceMappingURL=render-utils.js.map"],"file":"render-utils.min.js"}