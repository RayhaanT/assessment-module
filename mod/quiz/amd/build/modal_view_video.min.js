define ("mod_quiz/modal_view_video",["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/templates","core/ajax","core/modal_events"],function(a,b,c,d,e,f,g,h){var i=!1,j={ANALYZE_BUTTON:"[data-action=\"analyze\"]",MAJOR_FLAG:"[data-action=\"flagmajor\"]",MINOR_FLAG:"[data-action=\"flagminor\"]",CLEAR_FLAG:"[data-action=\"clear\"]"},k=function(a){this.attemptID=null;this.webroot=null;this.spinner=null;d.call(this,a);if(!this.getFooter().find(j.ANALYZE_BUTTON).length){b.exception({message:"No analyze button found"})}if(!this.getFooter().find(j.MAJOR_FLAG).length){b.exception({message:"No major flag button found"})}if(!this.getFooter().find(j.MINOR_FLAG).length){b.exception({message:"No minor flag button found"})}if(!this.getFooter().find(j.CLEAR_FLAG).length){b.exception({message:"No clear button found"})}};k.TYPE="mod_quiz-view_video";k.prototype=Object.create(d.prototype);k.prototype.constructor=k;k.prototype.addViolations=function(a){var c=this.spinner;c.style.display="block";var d=g.call([{methodname:"mod_quiz_record_proctoring_violation",args:{attemptid:this.attemptID,severity:a}}]);d[0].done(function(){c.style.display="none";location.reload()}).fail(function(a){b.exception({message:a})})};k.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this);this.getModal().on(c.events.activate,j.ANALYZE_BUTTON,function(){this.webroot+"/mod/quiz/serveproctorvideo.php?attemptid="+this.attemptID}.bind(this));this.getModal().on(c.events.activate,j.MAJOR_FLAG,function(){this.addViolations(2)}.bind(this));this.getModal().on(c.events.activate,j.MINOR_FLAG,function(){this.addViolations(1)}.bind(this));this.getModal().on(c.events.activate,j.CLEAR_FLAG,function(){this.addViolations(-10)}.bind(this))};k.prototype.show=function(){d.prototype.show.call(this);var a=document.getElementById("player");a.src=this.webroot+"/mod/quiz/serveproctorvideo.php?stream=true&&attemptid="+this.attemptID;this.spinner=document.getElementById("loading-spinner");this.getRoot().on(h.hidden,function(){a.pause()})};k.prototype.setAttemptID=function(a){this.attemptID=a};k.prototype.setWebroot=function(a){this.webroot=a};if(!i){e.register(k.TYPE,k,"mod_quiz/modal_view_video");i=!0}return k});
//# sourceMappingURL=modal_view_video.min.js.map
